<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>厦门天气</title>
    <style>
        @font-face {
            font-family: 'Microsoft YaHei Medium';
            src: local('Microsoft YaHei Medium');
            font-weight: 500;
        }

        :root {
            --primary-color: #c7e8ca;
            --text-dark: #2d3436;
            --main-font: 'Microsoft YaHei', system-ui, sans-serif;
            --accent-color: #0078d4;
            --sunny-color: #FFA500;
            --rainy-color: #4682B4;
            --cloudy-color: #778899;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--main-font);
            font-weight: 500;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            min-height: 100vh;
            background-size: cover;
            position: relative;
            overflow-x: hidden;
            padding: 20px;
        }

        /* 动态背景 */
        .weather-bg {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
            transition: all 1s ease;
            top: 0;
            left: 0;
        }

        .sunny-bg {
            background: linear-gradient(160deg, #fff1eb 0%, #ace0f9 100%);
            animation: sunGlow 8s infinite;
        }

        .rainy-bg {
            background: linear-gradient(160deg, #b1b1b1 0%, #5a7180 100%);
            animation: rainFall 1s infinite;
        }

        .cloudy-bg {
            background: linear-gradient(160deg, #dfe9f3 0%, #a3b8cc 100%);
        }

        /* 主卡片容器 */
        .main-container {
            position: relative;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
        }

        /* 位置信息 */
        .location-info {
            margin-bottom: 2rem;
            position: relative;
            cursor: pointer;
        }

        .location-cn {
            font-size: 3.5rem;
            color: var(--text-dark);
            line-height: 1.2;
            font-weight: 500;
            display: inline-block;
            position: relative;
            padding-right: 20px;
        }

        .location-en {
            font-size: 1.2rem;
            color: #666;
            margin-top: 0.5rem;
            font-weight: 500;
            cursor: pointer;
        }

        /* 编辑按钮样式 */
        .edit-icon {
            position: absolute;
            right: 0;
            bottom: 5px;
            font-size: 14px;
            color: #666;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            padding: 3px;
            border-radius: 3px;
            font-weight: 500;
        }

        .location-cn:hover .edit-icon {
            opacity: 1;
        }

        /* 温度区域 */
        .temp-section {
            display: flex;
            align-items: flex-start;
            gap: 3rem;
            margin-bottom: 3rem;
            position: relative;
        }

        .temp-main {
            flex: 1;
            cursor: pointer;
        }

        .current-temp {
            font-size: 5rem;
            font-weight: 500;
            color: var(--text-dark);
            line-height: 1;
        }

        .temp-range {
            font-size: 1.8rem;
            color: #666;
            margin-top: 1rem;
            font-weight: 500;
        }

        .weather-icon-container {
            width: 120px;
            height: 120px;
            position: absolute;
            right: 0;
            top: -20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .weather-icon {
            font-size: 8rem;
            animation: float 3s ease-in-out infinite;
        }

        .sunny-icon {
            color: var(--sunny-color);
            text-shadow: 0 0 10px rgba(255, 165, 0, 0.5);
        }

        .rainy-icon {
            color: var(--rainy-color);
        }

        .cloudy-icon {
            color: var(--cloudy-color);
        }

        /* 七日预报 */
        .weekly-forecast {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 3rem;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .day-card {
            min-width: 120px;
            background: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .day-card:hover {
            transform: translateY(-5px);
        }

        .day-card i {
            font-size: 2rem;
            margin: 0.5rem 0;
            display: inline-block;
            height: 32px;
            line-height: 32px;
        }

        .sunny-day-icon {
            color: var(--sunny-color);
        }

        .rainy-day-icon {
            color: var(--rainy-color);
        }

        .cloudy-day-icon {
            color: var(--cloudy-color);
        }

        /* 详情网格 */
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            max-width: 1000px;
        }

        .detail-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .detail-card:hover {
            transform: translateY(-5px);
        }

        .detail-card .label {
            font-size: 1rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .detail-card .value {
            font-size: 1.5rem;
            color: var(--text-dark);
            font-weight: 500;
        }

        /* 城市选择对话框 */
        .city-selector-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .city-selector-dialog {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .dialog-content {
            overflow-y: auto;
            padding: 0 20px;
            scrollbar-width: thin;
            scrollbar-color: #ccc #f5f5f5;
        }

        /* 自定义滚动条 */
        .dialog-content::-webkit-scrollbar {
            width: 8px;
        }

        .dialog-content::-webkit-scrollbar-track {
            background: #f5f5f5;
            border-radius: 4px;
        }

        .dialog-content::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }

        .dialog-content::-webkit-scrollbar-thumb:hover {
            background: #aaa;
        }

        .dialog-header {
            background: white;
            z-index: 3;
            padding: 20px 20px 10px;
            border-bottom: 1px solid #eee;
        }

        .dialog-title {
            font-size: 1.5rem;
            font-weight: 500;
        }

        .close-button {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 5px;
            font-weight: 500;
            position: absolute;
            right: 20px;
            top: 20px;
        }

        .input-container {
            background: white;
            z-index: 2;
            padding: 10px 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            border-bottom: 1px solid #eee;
        }

        .manual-input-container {
            display: flex;
            gap: 10px;
        }

        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            border-color: var(--accent-color);
        }

        .confirm-btn {
            padding: 10px 15px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            width: 25%;
        }

        .city-group-title {
            font-size: 1.2rem;
            font-weight: 500;
            margin: 15px 0 10px 0;
            color: var(--text-dark);
            background: white;
            padding: 5px 0;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .city-item {
            padding: 12px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #f0f0f0;
        }

        .city-item:hover {
            background: #f5f5f5;
        }

        .city-name {
            font-size: 1.1rem;
            color: var(--text-dark);
            margin-bottom: 3px;
            font-weight: 500;
        }

        .city-name-en {
            font-size: 0.9rem;
            color: #888;
            font-weight: 500;
        }

        .no-results {
            text-align: center;
            padding: 20px;
            color: #666;
            display: none;
        }

        /* 详情弹窗样式 */
        .detail-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .detail-dialog {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: auto;
            padding: 2rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.3s ease;
            position: relative;
        }

        .detail-dialog.active {
            transform: scale(1);
            opacity: 1;
        }

        .detail-close-button {
            position: absolute;
            right: 20px;
            top: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            font-weight: 500;
        }

        .detail-header {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .detail-title {
            font-size: 2rem;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .detail-subtitle {
            font-size: 1.2rem;
            color: #666;
        }

        .detail-content {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }

        .detail-item-title {
            font-size: 1.2rem;
            color: var(--text-dark);
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .detail-item-content {
            font-size: 1rem;
            color: #666;
            line-height: 1.6;
        }

        /* 动画定义 */
        @keyframes sunGlow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        @keyframes rainFall {
            from { background-position: 0 0; }
            to { background-position: 20% 100%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* 加载动画 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* 响应式设计 */
        @media (max-width: 1024px) {
            .detail-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .detail-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 1.5rem;
            }
            
            .location-cn {
                font-size: 2.5rem;
            }
            
            .temp-section {
                flex-direction: column;
                gap: 1.5rem;
            }
            
            .current-temp {
                font-size: 4rem;
            }
            
            .weather-icon-container {
                position: static;
                margin-top: 1rem;
            }
            
            .weather-icon {
                font-size: 6rem;
                position: static;
            }
            
            .detail-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .city-selector-dialog {
                width: 95%;
                max-height: 85vh;
            }
        }

        @media (max-width: 480px) {
            .location-cn {
                font-size: 2rem;
            }
            
            .detail-grid {
                grid-template-columns: 1fr;
            }
            
            .city-group-title {
                font-size: 1.1rem;
            }
            
            .city-name {
                font-size: 1rem;
            }
            
            .manual-input-container {
                flex-direction: column;
            }
            
            .confirm-btn {
                width: 100%;
            }
            
            .detail-title {
                font-size: 1.5rem;
            }
            
            .detail-subtitle {
                font-size: 1rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="weather-bg cloudy-bg"></div>

    <!-- 城市选择对话框 -->
    <div class="city-selector-overlay" id="citySelector">
        <div class="city-selector-dialog">
            <div class="dialog-header">
                <div class="dialog-title">位置选择</div>
                <button class="close-button" id="closeCitySelector">&times;</button>
            </div>
            
            <div class="input-container">
                <input type="text" class="search-input" id="citySearch" placeholder="搜索城市...">
                <div class="manual-input-container">
                    <input type="text" class="search-input" id="manualCityInput" placeholder="手动输入城市名称">
                    <button class="confirm-btn" id="confirmManualInput">确认</button>
                </div>
            </div>
            
            <div class="dialog-content">
                <div class="no-results" id="noResults">没有找到匹配的城市</div>
                
                <div class="city-group-title">常用城市</div>
                <div id="popularCities">
                    <!-- 常用城市将通过JS动态添加 -->
                </div>
                
                <div id="cityListByLetter">
                    <!-- 按字母排序的城市列表将通过JS动态添加 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 详情弹窗 -->
    <div class="detail-overlay" id="detailOverlay">
        <div class="detail-dialog" id="detailDialog">
            <button class="detail-close-button" id="detailCloseButton">&times;</button>
            <div class="detail-header">
                <div class="detail-title" id="detailTitle">详情信息</div>
                <div class="detail-subtitle" id="detailSubtitle">详细信息展示</div>
            </div>
            <div class="detail-content" id="detailContent">
                <!-- 详情内容将通过JS动态添加 -->
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- 位置信息 -->
        <div class="location-info" id="locationInfo">
            <div class="location-cn" id="locationText">厦门 福建 中国
                <i class="fas fa-pencil edit-icon" id="editButton"></i>
            </div>
            <div class="location-en" id="locationEn">Xiamen, Fujian China</div>
        </div>

        <!-- 温度区域 -->
        <div class="temp-section">
            <div class="temp-main" id="tempMain">
                <div class="current-temp" id="currentTemp">15°C</div>
                <div class="temp-range" id="tempRange">11°C - 15°C</div>
            </div>
            <div class="weather-icon-container">
                <i class="fas fa-cloud weather-icon cloudy-icon" id="weatherIcon"></i>
            </div>
        </div>

        <!-- 七日预报 -->
        <div class="weekly-forecast" id="weeklyForecast">
            <div class="day-card" data-day="0">
                <div>今天</div>
                <i class="fas fa-cloud cloudy-day-icon"></i>
                <div>11°-15°</div>
            </div>
            <div class="day-card" data-day="1">
                <div>周一</div>
                <i class="fas fa-cloud-sun cloudy-day-icon"></i>
                <div>12°-16°</div>
            </div>
            <div class="day-card" data-day="2">
                <div>周二</div>
                <i class="fas fa-cloud cloudy-day-icon"></i>
                <div>13°-17°</div>
            </div>
            <div class="day-card" data-day="3">
                <div>周三</div>
                <i class="fas fa-cloud-rain rainy-day-icon"></i>
                <div>14°-18°</div>
            </div>
            <div class="day-card" data-day="4">
                <div>周四</div>
                <i class="fas fa-rain rainy-day-icon"></i>
                <div>12°-16°</div>
            </div>
            <div class="day-card" data-day="5">
                <div>周五</div>
                <i class="fas fa-cloud-sun cloudy-day-icon"></i>
                <div>10°-14°</div>
            </div>
            <div class="day-card" data-day="6">
                <div>周六</div>
                <i class="fas fa-sun sunny-day-icon"></i>
                <div>9°-13°</div>
            </div>
        </div>

        <!-- 详情网格 -->
        <div class="detail-grid">
            <div class="detail-card" data-type="feelsLike">
                <div class="label">体感温度</div>
                <div class="value" id="feelsLike">14°C</div>
            </div>
            <div class="detail-card" data-type="humidity">
                <div class="label">湿度</div>
                <div class="value" id="humidity">75%</div>
            </div>
            <div class="detail-card" data-type="windSpeed">
                <div class="label">风速</div>
                <div class="value" id="windSpeed">10km/h</div>
            </div>
            <div class="detail-card" data-type="pressure">
                <div class="label">气压</div>
                <div class="value" id="pressure">1012hPa</div>
            </div>
            <div class="detail-card" data-type="visibility">
                <div class="label">能见度</div>
                <div class="value" id="visibility">8km</div>
            </div>
            <div class="detail-card" data-type="uvIndex">
                <div class="label">紫外线</div>
                <div class="value" id="uvIndex">弱</div>
            </div>
            <div class="detail-card" data-type="precipitation">
                <div class="label">降水量</div>
                <div class="value" id="precipitation">0.2mm</div>
            </div>
            <div class="detail-card" data-type="airQuality">
                <div class="label">空气质量</div>
                <div class="value" id="airQuality">良</div>
            </div>
            <div class="detail-card" data-type="windDirection">
                <div class="label">风向</div>
                <div class="value" id="windDirection">东北风</div>
            </div>
            <div class="detail-card" data-type="windDirectionDegree">
                <div class="label">风向角度</div>
                <div class="value" id="windDirectionDegree">45°</div>
            </div>
            <div class="detail-card" data-type="windScale">
                <div class="label">风速等级</div>
                <div class="value" id="windScale">3级</div>
            </div>
            <div class="detail-card" data-type="weatherCondition">
                <div class="label">天气状况</div>
                <div class="value" id="weatherCondition">多云</div>
            </div>
            <div class="detail-card" data-type="sunrise">
                <div class="label">日出时间</div>
                <div class="value" id="sunrise">06:30</div>
            </div>
            <div class="detail-card" data-type="sunset">
                <div class="label">日落时间</div>
                <div class="value" id="sunset">17:45</div>
            </div>
            <div class="detail-card" data-type="aqi">
                <div class="label">AQI指数</div>
                <div class="value" id="aqi">65</div>
            </div>
            <div class="detail-card" data-type="pm25">
                <div class="label">PM2.5</div>
                <div class="value" id="pm25">35</div>
            </div>
            <div class="detail-card" data-type="pm10">
                <div class="label">PM10</div>
                <div class="value" id="pm10">60</div>
            </div>
        </div>
    </div>

    <script>
        // 中国一二三线城市数据
        const chineseCities = {
            popular: [
                { cn: '北京 中国', en: 'Beijing, China', id: '北京', sheng: '北京' },
                { cn: '上海 中国', en: 'Shanghai, China', id: '上海', sheng: '上海' },
                { cn: '广州 广东 中国', en: 'Guangzhou, Guangdong China', id: '广州', sheng: '广东' },
                { cn: '深圳 广东 中国', en: 'Shenzhen, Guangdong China', id: '深圳', sheng: '广东' },
                { cn: '厦门 福建 中国', en: 'Xiamen, Fujian China', id: '厦门', sheng: '福建' },
                { cn: '成都 四川 中国', en: 'Chengdu, Sichuan China', id: '成都', sheng: '四川' }
            ],
            byLetter: {
                'A': [
                    { cn: '安庆 安徽 中国', en: 'Anqing, Anhui China', id: '安庆', sheng: '安徽' },
                    { cn: '鞍山 辽宁 中国', en: 'Anshan, Liaoning China', id: '鞍山', sheng: '辽宁' }
                ],
                'B': [
                    { cn: '北京 中国', en: 'Beijing, China', id: '北京', sheng: '北京' },
                    { cn: '保定 河北 中国', en: 'Baoding, Hebei China', id: '保定', sheng: '河北' },
                    { cn: '包头 内蒙古 中国', en: 'Baotou, Inner Mongolia China', id: '包头', sheng: '内蒙古' },
                    { cn: '北海 广西 中国', en: 'Beihai, Guangxi China', id: '北海', sheng: '广西' },
                    { cn: '蚌埠 安徽 中国', en: 'Bengbu, Anhui China', id: '蚌埠', sheng: '安徽' }
                ],
                'C': [
                    { cn: '重庆 中国', en: 'Chongqing, China', id: '重庆', sheng: '重庆' },
                    { cn: '成都 四川 中国', en: 'Chengdu, Sichuan China', id: '成都', sheng: '四川' },
                    { cn: '长沙 湖南 中国', en: 'Changsha, Hunan China', id: '长沙', sheng: '湖南' },
                    { cn: '长春 吉林 中国', en: 'Changchun, Jilin China', id: '长春', sheng: '吉林' },
                    { cn: '常州 江苏 中国', en: 'Changzhou, Jiangsu China', id: '常州', sheng: '江苏' },
                    { cn: '潮州 广东 中国', en: 'Chaozhou, Guangdong China', id: '潮州', sheng: '广东' }
                ],
                'D': [
                    { cn: '大连 辽宁 中国', en: 'Dalian, Liaoning China', id: '大连', sheng: '辽宁' },
                    { cn: '东莞 广东 中国', en: 'Dongguan, Guangdong China', id: '东莞', sheng: '广东' },
                    { cn: '大庆 黑龙江 中国', en: 'Daqing, Heilongjiang China', id: '大庆', sheng: '黑龙江' },
                    { cn: '大同 山西 中国', en: 'Datong, Shanxi China', id: '大同', sheng: '山西' },
                    { cn: '丹东 辽宁 中国', en: 'Dandong, Liaoning China', id: '丹东', sheng: '辽宁' }
                ],
                'E': [
                    { cn: '鄂尔多斯 内蒙古 中国', en: 'Ordos, Inner Mongolia China', id: '鄂尔多斯', sheng: '内蒙古' },
                    { cn: '恩施 湖北 中国', en: 'Enshi, Hubei China', id: '恩施', sheng: '湖北' }
                ],
                'F': [
                    { cn: '福州 福建 中国', en: 'Fuzhou, Fujian China', id: '福州', sheng: '福建' },
                    { cn: '佛山 广东 中国', en: 'Foshan, Guangdong China', id: '佛山', sheng: '广东' },
                    { cn: '抚顺 辽宁 中国', en: 'Fushun, Liaoning China', id: '抚顺', sheng: '辽宁' },
                    { cn: '阜阳 安徽 中国', en: 'Fuyang, Anhui China', id: '阜阳', sheng: '安徽' }
                ],
                'G': [
                    { cn: '广州 广东 中国', en: 'Guangzhou, Guangdong China', id: '广州', sheng: '广东' },
                    { cn: '桂林 广西 中国', en: 'Guilin, Guangxi China', id: '桂林', sheng: '广西' },
                    { cn: '贵阳 贵州 中国', en: 'Guiyang, Guizhou China', id: '贵阳', sheng: '贵州' },
                    { cn: '赣州 江西 中国', en: 'Ganzhou, Jiangxi China', id: '赣州', sheng: '江西' },
                    { cn: '广元 四川 中国', en: 'Guangyuan, Sichuan China', id: '广元', sheng: '四川' }
                ],
                'H': [
                    { cn: '杭州 浙江 中国', en: 'Hangzhou, Zhejiang China', id: '杭州', sheng: '浙江' },
                    { cn: '合肥 安徽 中国', en: 'Hefei, Anhui China', id: '合肥', sheng: '安徽' },
                    { cn: '哈尔滨 黑龙江 中国', en: 'Harbin, Heilongjiang China', id: '哈尔滨', sheng: '黑龙江' },
                    { cn: '海口 海南 中国', en: 'Haikou, Hainan China', id: '海口', sheng: '海南' },
                    { cn: '呼和浩特 内蒙古 中国', en: 'Hohhot, Inner Mongolia China', id: '呼和浩特', sheng: '内蒙古' },
                    { cn: '邯郸 河北 中国', en: 'Handan, Hebei China', id: '邯郸', sheng: '河北' }
                ],
                'J': [
                    { cn: '济南 山东 中国', en: 'Jinan, Shandong China', id: '济南', sheng: '山东' },
                    { cn: '吉林 吉林 中国', en: 'Jilin, Jilin China', id: '吉林', sheng: '吉林' },
                    { cn: '嘉兴 浙江 中国', en: 'Jiaxing, Zhejiang China', id: '嘉兴', sheng: '浙江' },
                    { cn: '九江 江西 中国', en: 'Jiujiang, Jiangxi China', id: '九江', sheng: '江西' },
                    { cn: '江门 广东 中国', en: 'Jiangmen, Guangdong China', id: '江门', sheng: '广东' }
                ],
                'K': [
                    { cn: '昆明 云南 中国', en: 'Kunming, Yunnan China', id: '昆明', sheng: '云南' },
                    { cn: '开封 河南 中国', en: 'Kaifeng, Henan China', id: '开封', sheng: '河南' },
                    { cn: '克拉玛依 新疆 中国', en: 'Karamay, Xinjiang China', id: '克拉玛依', sheng: '新疆' }
                ],
                'L': [
                    { cn: '兰州 甘肃 中国', en: 'Lanzhou, Gansu China', id: '兰州', sheng: '甘肃' },
                    { cn: '拉萨 西藏 中国', en: 'Lhasa, Tibet China', id: '拉萨', sheng: '西藏' },
                    { cn: '洛阳 河南 中国', en: 'Luoyang, Henan China', id: '洛阳', sheng: '河南' },
                    { cn: '连云港 江苏 中国', en: 'Lianyungang, Jiangsu China', id: '连云港', sheng: '江苏' },
                    { cn: '柳州 广西 中国', en: 'Liuzhou, Guangxi China', id: '柳州', sheng: '广西' }
                ],
                'M': [
                    { cn: '绵阳 四川 中国', en: 'Mianyang, Sichuan China', id: '绵阳', sheng: '四川' },
                    { cn: '马鞍山 安徽 中国', en: 'Maanshan, Anhui China', id: '马鞍山', sheng: '安徽' },
                    { cn: '牡丹江 黑龙江 中国', en: 'Mudanjiang, Heilongjiang China', id: '牡丹江', sheng: '黑龙江' }
                ],
                'N': [
                    { cn: '南京 江苏 中国', en: 'Nanjing, Jiangsu China', id: '南京', sheng: '江苏' },
                    { cn: '宁波 浙江 中国', en: 'Ningbo, Zhejiang China', id: '宁波', sheng: '浙江' },
                    { cn: '南昌 江西 中国', en: 'Nanchang, Jiangxi China', id: '南昌', sheng: '江西' },
                    { cn: '南宁 广西 中国', en: 'Nanning, Guangxi China', id: '南宁', sheng: '广西' },
                    { cn: '南通 江苏 中国', en: 'Nantong, Jiangsu China', id: '南通', sheng: '江苏' }
                ],
                'P': [
                    { cn: '平顶山 河南 中国', en: 'Pingdingshan, Henan China', id: '平顶山', sheng: '河南' },
                    { cn: '盘锦 辽宁 中国', en: 'Panjin, Liaoning China', id: '盘锦', sheng: '辽宁' },
                    { cn: '莆田 福建 中国', en: 'Putian, Fujian China', id: '莆田', sheng: '福建' }
                ],
                'Q': [
                    { cn: '青岛 山东 中国', en: 'Qingdao, Shandong China', id: '青岛', sheng: '山东' },
                    { cn: '泉州 福建 中国', en: 'Quanzhou, Fujian China', id: '泉州', sheng: '福建' },
                    { cn: '秦皇岛 河北 中国', en: 'Qinhuangdao, Hebei China', id: '秦皇岛', sheng: '河北' },
                    { cn: '齐齐哈尔 黑龙江 中国', en: 'Qiqihar, Heilongjiang China', id: '齐齐哈尔', sheng: '黑龙江' }
                ],
                'R': [
                    { cn: '日照 山东 中国', en: 'Rizhao, Shandong China', id: '日照', sheng: '山东' }
                ],
                'S': [
                    { cn: '上海 中国', en: 'Shanghai, China', id: '上海', sheng: '上海' },
                    { cn: '深圳 广东 中国', en: 'Shenzhen, Guangdong China', id: '深圳', sheng: '广东' },
                    { cn: '苏州 江苏 中国', en: 'Suzhou, Jiangsu China', id: '苏州', sheng: '江苏' },
                    { cn: '沈阳 辽宁 中国', en: 'Shenyang, Liaoning China', id: '沈阳', sheng: '辽宁' },
                    { cn: '石家庄 河北 中国', en: 'Shijiazhuang, Hebei China', id: '石家庄', sheng: '河北' },
                    { cn: '三亚 海南 中国', en: 'Sanya, Hainan China', id: '三亚', sheng: '海南' }
                ],
                'T': [
                    { cn: '天津 中国', en: 'Tianjin, China', id: '天津', sheng: '天津' },
                    { cn: '太原 山西 中国', en: 'Taiyuan, Shanxi China', id: '太原', sheng: '山西' },
                    { cn: '唐山 河北 中国', en: 'Tangshan, Hebei China', id: '唐山', sheng: '河北' },
                    { cn: '泰安 山东 中国', en: 'Tai\'an, Shandong China', id: '泰安', sheng: '山东' },
                    { cn: '台州 浙江 中国', en: 'Taizhou, Zhejiang China', id: '台州', sheng: '浙江' }
                ],
                'W': [
                    { cn: '武汉 湖北 中国', en: 'Wuhan, Hubei China', id: '武汉', sheng: '湖北' },
                    { cn: '无锡 江苏 中国', en: 'Wuxi, Jiangsu China', id: '无锡', sheng: '江苏' },
                    { cn: '温州 浙江 中国', en: 'Wenzhou, Zhejiang China', id: '温州', sheng: '浙江' },
                    { cn: '乌鲁木齐 新疆 中国', en: 'Urumqi, Xinjiang China', id: '乌鲁木齐', sheng: '新疆' },
                    { cn: '潍坊 山东 中国', en: 'Weifang, Shandong China', id: '潍坊', sheng: '山东' }
                ],
                'X': [
                    { cn: '西安 陕西 中国', en: 'Xi\'an, Shaanxi China', id: '西安', sheng: '陕西' },
                    { cn: '厦门 福建 中国', en: 'Xiamen, Fujian China', id: '厦门', sheng: '福建' },
                    { cn: '徐州 江苏 中国', en: 'Xuzhou, Jiangsu China', id: '徐州', sheng: '江苏' },
                    { cn: '西宁 青海 中国', en: 'Xining, Qinghai China', id: '西宁', sheng: '青海' },
                    { cn: '襄阳 湖北 中国', en: 'Xiangyang, Hubei China', id: '襄阳', sheng: '湖北' }
                ],
                'Y': [
                    { cn: '烟台 山东 中国', en: 'Yantai, Shandong China', id: '烟台', sheng: '山东' },
                    { cn: '银川 宁夏 中国', en: 'Yinchuan, Ningxia China', id: '银川', sheng: '宁夏' },
                    { cn: '扬州 江苏 中国', en: 'Yangzhou, Jiangsu China', id: '扬州', sheng: '江苏' },
                    { cn: '宜昌 湖北 中国', en: 'Yichang, Hubei China', id: '宜昌', sheng: '湖北' },
                    { cn: '义乌 浙江 中国', en: 'Yiwu, Zhejiang China', id: '义乌', sheng: '浙江' }
                ],
                'Z': [
                    { cn: '郑州 河南 中国', en: 'Zhengzhou, Henan China', id: '郑州', sheng: '河南' },
                    { cn: '珠海 广东 中国', en: 'Zhuhai, Guangdong China', id: '珠海', sheng: '广东' },
                    { cn: '中山 广东 中国', en: 'Zhongshan, Guangdong China', id: '中山', sheng: '广东' },
                    { cn: '淄博 山东 中国', en: 'Zibo, Shandong China', id: '淄博', sheng: '山东' },
                    { cn: '镇江 江苏 中国', en: 'Zhenjiang, Jiangsu China', id: '镇江', sheng: '江苏' }
                ]
            }
        };

        // 当前选中的城市
        let currentCity = {
            id: '厦门',
            sheng: '福建',
            cn: '厦门 福建 中国',
            en: 'Xiamen, Fujian China'
        };

        // 天气数据缓存
        let weatherCache = {};

        // 初始化城市选择对话框
        function initCitySelector() {
            const popularCitiesContainer = document.getElementById('popularCities');
            const cityListByLetterContainer = document.getElementById('cityListByLetter');
            
            // 添加常用城市
            chineseCities.popular.forEach(city => {
                const cityItem = document.createElement('div');
                cityItem.className = 'city-item';
                cityItem.innerHTML = `
                    <div class="city-name">${city.cn}</div>
                    <div class="city-name-en">${city.en}</div>
                `;
                cityItem.addEventListener('click', () => {
                    selectCity(city);
                });
                popularCitiesContainer.appendChild(cityItem);
            });
            
            // 按字母顺序添加城市
            Object.keys(chineseCities.byLetter).sort().forEach(letter => {
                const letterGroup = document.createElement('div');
                const groupTitle = document.createElement('div');
                groupTitle.className = 'city-group-title';
                groupTitle.textContent = letter;
                letterGroup.appendChild(groupTitle);
                
                chineseCities.byLetter[letter].forEach(city => {
                    const cityItem = document.createElement('div');
                    cityItem.className = 'city-item';
                    cityItem.innerHTML = `
                        <div class="city-name">${city.cn}</div>
                        <div class="city-name-en">${city.en}</div>
                    `;
                    cityItem.addEventListener('click', () => {
                        selectCity(city);
                    });
                    letterGroup.appendChild(cityItem);
                });
                
                cityListByLetterContainer.appendChild(letterGroup);
            });

            // 添加搜索功能
            const citySearch = document.getElementById('citySearch');
            const noResults = document.getElementById('noResults');
            
            citySearch.addEventListener('input', (e) => {
                const searchTerm = e.target.value.trim().toLowerCase();
                
                if (searchTerm === '') {
                    // 清空搜索框，恢复初始状态
                    document.querySelectorAll('.city-item').forEach(item => {
                        item.style.display = 'block';
                    });
                    document.querySelectorAll('.city-group-title').forEach(title => {
                        title.style.display = 'block';
                    });
                    noResults.style.display = 'none';
                    return;
                }
                
                let hasResults = false;
                
                // 隐藏所有城市项
                document.querySelectorAll('.city-item').forEach(item => {
                    item.style.display = 'none';
                });
                
                // 隐藏所有字母标题
                document.querySelectorAll('.city-group-title').forEach(title => {
                    title.style.display = 'none';
                });
                
                // 搜索匹配的城市
                for (const letter in chineseCities.byLetter) {
                    for (const city of chineseCities.byLetter[letter]) {
                        // 检查中文名、拼音首字母、全拼
                        const pinyin = getPinyin(city.id);
                        const pinyinInitials = getPinyinInitials(city.id);
                        
                        if (city.cn.toLowerCase().includes(searchTerm) || 
                            city.en.toLowerCase().includes(searchTerm) ||
                            pinyin.toLowerCase().includes(searchTerm) ||
                            pinyinInitials.toLowerCase().includes(searchTerm)) {
                            
                            // 显示匹配的城市
                            const cityItems = document.querySelectorAll('.city-item');
                            for (const item of cityItems) {
                                if (item.querySelector('.city-name').textContent === city.cn) {
                                    item.style.display = 'block';
                                    hasResults = true;
                                    break;
                                }
                            }
                        }
                    }
                }
                
                // 检查常用城市
                for (const city of chineseCities.popular) {
                    const pinyin = getPinyin(city.id);
                    const pinyinInitials = getPinyinInitials(city.id);
                    
                    if (city.cn.toLowerCase().includes(searchTerm) || 
                        city.en.toLowerCase().includes(searchTerm) ||
                        pinyin.toLowerCase().includes(searchTerm) ||
                        pinyinInitials.toLowerCase().includes(searchTerm)) {
                        
                        const cityItems = document.querySelectorAll('.city-item');
                        for (const item of cityItems) {
                            if (item.querySelector('.city-name').textContent === city.cn) {
                                item.style.display = 'block';
                                hasResults = true;
                                break;
                            }
                        }
                    }
                }
                
                // 显示/隐藏"没有结果"提示
                noResults.style.display = hasResults ? 'none' : 'block';
            });

            // 手动输入城市功能
            const manualCityInput = document.getElementById('manualCityInput');
            const confirmManualInput = document.getElementById('confirmManualInput');
            
            confirmManualInput.addEventListener('click', () => {
                const cityName = manualCityInput.value.trim();
                if (cityName) {
                    currentCity = {
                        id: cityName,
                        sheng: '',
                        cn: cityName + ' 中国',
                        en: cityName + ', China'
                    };
                    
                    updateLocationDisplay();
                    fetchWeatherData(currentCity, true);
                    document.getElementById('citySelector').style.display = 'none';
                    manualCityInput.value = '';
                    citySearch.value = '';
                    
                    // 恢复城市列表显示
                    document.querySelectorAll('.city-item').forEach(item => {
                        item.style.display = 'block';
                    });
                    document.querySelectorAll('.city-group-title').forEach(title => {
                        title.style.display = 'block';
                    });
                    document.getElementById('noResults').style.display = 'none';
                }
            });
        }

        // 选择城市
        function selectCity(city) {
            currentCity = city;
            updateLocationDisplay();
            fetchWeatherData(city, true); // 强制更新天气数据
            document.getElementById('citySelector').style.display = 'none';
            document.getElementById('citySearch').value = '';
            document.getElementById('manualCityInput').value = '';
            
            // 恢复城市列表显示
            document.querySelectorAll('.city-item').forEach(item => {
                item.style.display = 'block';
            });
            document.querySelectorAll('.city-group-title').forEach(title => {
                title.style.display = 'block';
            });
            document.getElementById('noResults').style.display = 'none';
        }

        // 更新位置显示
        function updateLocationDisplay() {
            document.getElementById('locationText').textContent = currentCity.cn;
            document.getElementById('locationText').innerHTML = currentCity.cn + '<i class="fas fa-pencil edit-icon" id="editButton"></i>';
            document.getElementById('locationEn').textContent = currentCity.en;
            
            // 重新绑定编辑按钮事件
            document.getElementById('editButton').addEventListener('click', editButton.onclick);
        }

        // 获取拼音
        function getPinyin(chinese) {
            const pinyinMap = {
                '北京': 'beijing',
                '上海': 'shanghai',
                '广州': 'guangzhou',
                '深圳': 'shenzhen',
                '厦门': 'xiamen',
                '成都': 'chengdu',
                '安庆': 'anqing',
                '鞍山': 'anshan',
                '保定': 'baoding',
                '包头': 'baotou',
                '北海': 'beihai',
                '蚌埠': 'bengbu',
                '重庆': 'chongqing',
                '长沙': 'changsha',
                '长春': 'changchun',
                '常州': 'changzhou',
                '潮州': 'chaozhou',
                '大连': 'dalian',
                '东莞': 'dongguan',
                '大庆': 'daqing',
                '大同': 'datong',
                '丹东': 'dandong',
                '鄂尔多斯': 'eerduosi',
                '恩施': 'enshi',
                '福州': 'fuzhou',
                '佛山': 'foshan',
                '抚顺': 'fushun',
                '阜阳': 'fuyang',
                '桂林': 'guilin',
                '贵阳': 'guiyang',
                '赣州': 'ganzhou',
                '广元': 'guangyuan',
                '杭州': 'hangzhou',
                '合肥': 'hefei',
                '哈尔滨': 'haerbin',
                '海口': 'haikou',
                '呼和浩特': 'huhehaote',
                '邯郸': 'handan',
                '济南': 'jinan',
                '吉林': 'jilin',
                '嘉兴': 'jiaxing',
                '九江': 'jiujiang',
                '江门': 'jiangmen',
                '昆明': 'kunming',
                '开封': 'kaifeng',
                '克拉玛依': 'kelamayi',
                '兰州': 'lanzhou',
                '拉萨': 'lasa',
                '洛阳': 'luoyang',
                '连云港': 'lianyungang',
                '柳州': 'liuzhou',
                '绵阳': 'mianyang',
                '马鞍山': 'maanshan',
                '牡丹江': 'mudanjiang',
                '南京': 'nanjing',
                '宁波': 'ningbo',
                '南昌': 'nanchang',
                '南宁': 'nanning',
                '南通': 'nantong',
                '平顶山': 'pingdingshan',
                '盘锦': 'panjin',
                '莆田': 'putian',
                '青岛': 'qingdao',
                '泉州': 'quanzhou',
                '秦皇岛': 'qinhuangdao',
                '齐齐哈尔': 'qiqihaer',
                '日照': 'rizhao',
                '苏州': 'suzhou',
                '沈阳': 'shenyang',
                '石家庄': 'shijiazhuang',
                '三亚': 'sanya',
                '天津': 'tianjin',
                '太原': 'taiyuan',
                '唐山': 'tangshan',
                '泰安': 'taian',
                '台州': 'taizhou',
                '武汉': 'wuhan',
                '无锡': 'wuxi',
                '温州': 'wenzhou',
                '乌鲁木齐': 'wulumuqi',
                '潍坊': 'weifang',
                '西安': 'xian',
                '徐州': 'xuzhou',
                '西宁': 'xining',
                '襄阳': 'xiangyang',
                '烟台': 'yantai',
                '银川': 'yinchuan',
                '扬州': 'yangzhou',
                '宜昌': 'yichang',
                '义乌': 'yiwu',
                '郑州': 'zhengzhou',
                '珠海': 'zhuhai',
                '中山': 'zhongshan',
                '淄博': 'zibo',
                '镇江': 'zhenjiang'
            };
            
            return pinyinMap[chinese] || '';
        }

        // 获取拼音首字母
        function getPinyinInitials(chinese) {
            const pinyin = getPinyin(chinese);
            return pinyin.split('').filter((char, index) => {
                // 取每个音节的首字母
                return index === 0 || pinyin[index-1] === ' ';
            }).join('').replace(/\s+/g, '');
        }

        // 编辑功能
        const locationInfo = document.getElementById('locationInfo');
        const editButton = document.getElementById('editButton');
        const citySelector = document.getElementById('citySelector');
        const closeCitySelector = document.getElementById('closeCitySelector');
        const tempMain = document.getElementById('tempMain');
        const locationEn = document.getElementById('locationEn');

        // 点击位置区域
        locationInfo.addEventListener('click', () => {
            citySelector.style.display = 'flex';
            document.getElementById('citySearch').focus();
        });

        // 点击英文位置
        locationEn.addEventListener('click', (e) => {
            e.stopPropagation();
            citySelector.style.display = 'flex';
            document.getElementById('citySearch').focus();
        });

        // 点击编辑按钮
        editButton.addEventListener('click', (e) => {
            e.stopPropagation();
            citySelector.style.display = 'flex';
            document.getElementById('citySearch').focus();
        });

        // 点击关闭按钮
        closeCitySelector.addEventListener('click', () => {
            citySelector.style.display = 'none';
        });

        // 点击对话框外部关闭
        citySelector.addEventListener('click', (e) => {
            if (e.target === citySelector) {
                citySelector.style.display = 'none';
            }
        });

        // 点击温度区域刷新天气
        tempMain.addEventListener('click', () => {
            refreshWeather();
        });

        // 刷新天气
        function refreshWeather() {
            const tempElement = document.getElementById('currentTemp');
            const originalText = tempElement.textContent;
            
            // 显示加载动画
            tempElement.innerHTML = '<span class="loading"></span>';
            
            fetchWeatherData(currentCity, true, () => {
                // 恢复原始文本
                tempElement.textContent = originalText;
            });
        }

        // 获取天气数据
        function fetchWeatherData(city, forceUpdate = false, callback) {
            // 检查缓存
            const cacheKey = `${city.sheng}_${city.id}`;
            const cachedData = weatherCache[cacheKey];
            
            if (!forceUpdate && cachedData && (Date.now() - cachedData.timestamp) < 60000) { // 1分钟缓存
                updateWeatherUI(cachedData.data);
                if (callback) callback();
                return;
            }
            
            // API参数
            const apiUrl = `https://cn.apihz.cn/api/tianqi/tqyb.php?id=88888888&key=88888888&sheng=${encodeURIComponent(city.sheng)}&place=${encodeURIComponent(city.id)}`;
            
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.code === '200') {
                        // 缓存数据
                        weatherCache[cacheKey] = {
                            data: data,
                            timestamp: Date.now()
                        };
                        
                        updateWeatherUI(data);
                    } else {
                        console.error('天气数据获取失败:', data.msg);
                        // 使用默认数据
                        updateWeatherUI({
                            place: city.id,
                            temperature: '15',
                            tempRange: '11°C - 15°C',
                            feelsLike: '14',
                            humidity: '75',
                            windSpeed: '10',
                            pressure: '1012',
                            visibility: '8',
                            uvIndex: '弱',
                            precipitation: '0.2',
                            airQuality: '良',
                            windDirection: '东北风',
                            windDirectionDegree: '45',
                            windScale: '3级',
                            weather1: '多云',
                            weather2: '',
                            sunrise: '06:30',
                            sunset: '17:45',
                            aqi: '65',
                            pm25: '35',
                            pm10: '60'
                        });
                    }
                    
                    if (callback) callback();
                })
                .catch(error => {
                    console.error('获取天气数据时出错:', error);
                    updateWeatherUI({
                        place: city.id,
                        temperature: '15',
                        tempRange: '11°C - 15°C',
                        feelsLike: '14',
                        humidity: '75',
                        windSpeed: '10',
                        pressure: '1012',
                        visibility: '8',
                        uvIndex: '弱',
                        precipitation: '0.2',
                        airQuality: '良',
                        windDirection: '东北风',
                        windDirectionDegree: '45',
                        windScale: '3级',
                        weather1: '多云',
                        weather2: '',
                        sunrise: '06:30',
                        sunset: '17:45',
                        aqi: '65',
                        pm25: '35',
                        pm10: '60'
                    });
                    if (callback) callback();
                });
        }

        // 更新天气UI
        function updateWeatherUI(data) {
            // 更新温度信息
            document.getElementById('currentTemp').textContent = `${data.temperature}°C`;
            document.getElementById('tempRange').textContent = data.tempRange || `${parseInt(data.temperature)-4}°C - ${data.temperature}°C`;
            
            // 更新其他天气信息
            document.getElementById('feelsLike').textContent = `${data.feelsLike || (parseInt(data.temperature)-1)}°C`;
            document.getElementById('humidity').textContent = `${data.humidity}%`;
            document.getElementById('windSpeed').textContent = `${data.windSpeed}km/h`;
            document.getElementById('pressure').textContent = `${data.pressure || '1012'}hPa`;
            document.getElementById('visibility').textContent = `${data.visibility || '8'}km`;
            document.getElementById('uvIndex').textContent = data.uvIndex || '弱';
            document.getElementById('precipitation').textContent = `${data.precipitation || '0.2'}mm`;
            document.getElementById('airQuality').textContent = data.airQuality || '良';
            document.getElementById('windDirection').textContent = data.windDirection || '东北风';
            document.getElementById('windDirectionDegree').textContent = `${data.windDirectionDegree || '45'}°`;
            document.getElementById('windScale').textContent = data.windScale || '3级';
            document.getElementById('weatherCondition').textContent = data.weather1 || '多云';
            document.getElementById('sunrise').textContent = data.sunrise || '06:30';
            document.getElementById('sunset').textContent = data.sunset || '17:45';
            document.getElementById('aqi').textContent = data.aqi || '65';
            document.getElementById('pm25').textContent = data.pm25 || '35';
            document.getElementById('pm10').textContent = data.pm10 || '60';
            
            // 根据天气情况设置图标和背景
            const weatherIcon = document.getElementById('weatherIcon');
            const weatherBg = document.querySelector('.weather-bg');
            
            // 移除所有可能的类
            weatherIcon.className = 'fas weather-icon';
            weatherBg.className = 'weather-bg';
            
            // 根据天气情况添加相应类
            const weatherCondition = (data.weather1 || '多云').toLowerCase();
            
            if (weatherCondition.includes('晴')) {
                weatherIcon.classList.add('fa-sun', 'sunny-icon');
                weatherBg.classList.add('sunny-bg');
            } else if (weatherCondition.includes('雨')) {
                weatherIcon.classList.add('fa-cloud-rain', 'rainy-icon');
                weatherBg.classList.add('rainy-bg');
            } else if (weatherCondition.includes('云') || weatherCondition.includes('阴')) {
                weatherIcon.classList.add('fa-cloud', 'cloudy-icon');
                weatherBg.classList.add('cloudy-bg');
            } else {
                // 默认多云
                weatherIcon.classList.add('fa-cloud', 'cloudy-icon');
                weatherBg.classList.add('cloudy-bg');
            }
        }

        // 初始化详情弹窗
        function initDetailDialog() {
            const detailOverlay = document.getElementById('detailOverlay');
            const detailDialog = document.getElementById('detailDialog');
            const detailCloseButton = document.getElementById('detailCloseButton');
            
            // 关闭详情弹窗
            detailCloseButton.addEventListener('click', () => {
                detailOverlay.style.display = 'none';
            });
            
            // 点击外部关闭
            detailOverlay.addEventListener('click', (e) => {
                if (e.target === detailOverlay) {
                    detailOverlay.style.display = 'none';
                }
            });
            
            // 为七日预报卡片添加点击事件
            document.querySelectorAll('.day-card').forEach(card => {
                card.addEventListener('click', () => {
                    showDayDetail(card);
                });
            });
            
            // 为详情卡片添加点击事件
            document.querySelectorAll('.detail-card').forEach(card => {
                card.addEventListener('click', () => {
                    showDetailCard(card);
                });
            });
        }
        
        // 显示某天的详细天气
        function showDayDetail(card) {
            const detailOverlay = document.getElementById('detailOverlay');
            const detailDialog = document.getElementById('detailDialog');
            const detailTitle = document.getElementById('detailTitle');
            const detailSubtitle = document.getElementById('detailSubtitle');
            const detailContent = document.getElementById('detailContent');
            
            const day = card.querySelector('div:first-child').textContent;
            const tempRange = card.querySelector('div:last-child').textContent;
            const weatherIcon = card.querySelector('i');
            
            // 设置标题和副标题
            detailTitle.textContent = `${day}天气详情`;
            detailSubtitle.textContent = `${currentCity.cn} - ${tempRange}`;
            
            // 清空内容
            detailContent.innerHTML = '';
            
            // 添加天气图标
            const iconItem = document.createElement('div');
            iconItem.className = 'detail-item';
            iconItem.innerHTML = `
                <div class="detail-item-title">天气状况</div>
                <div class="detail-item-content" style="text-align: center; font-size: 3rem;">
                    ${weatherIcon.outerHTML}
                </div>
            `;
            detailContent.appendChild(iconItem);
            
            // 添加温度范围
            const tempItem = document.createElement('div');
            tempItem.className = 'detail-item';
            tempItem.innerHTML = `
                <div class="detail-item-title">温度范围</div>
                <div class="detail-item-content">${tempRange}</div>
            `;
            detailContent.appendChild(tempItem);
            
            // 添加其他信息
            const infoItems = [
                { title: '体感温度', value: document.getElementById('feelsLike').textContent },
                { title: '湿度', value: document.getElementById('humidity').textContent },
                { title: '风速', value: document.getElementById('windSpeed').textContent },
                { title: '风向', value: document.getElementById('windDirection').textContent },
                { title: '降水量', value: document.getElementById('precipitation').textContent },
                { title: '紫外线', value: document.getElementById('uvIndex').textContent }
            ];
            
            infoItems.forEach(item => {
                const infoItem = document.createElement('div');
                infoItem.className = 'detail-item';
                infoItem.innerHTML = `
                    <div class="detail-item-title">${item.title}</div>
                    <div class="detail-item-content">${item.value}</div>
                `;
                detailContent.appendChild(infoItem);
            });
            
            // 显示弹窗
            detailOverlay.style.display = 'flex';
            setTimeout(() => {
                detailDialog.classList.add('active');
            }, 10);
        }
        
        // 显示详情卡片
        function showDetailCard(card) {
            const detailOverlay = document.getElementById('detailOverlay');
            const detailDialog = document.getElementById('detailDialog');
            const detailTitle = document.getElementById('detailTitle');
            const detailSubtitle = document.getElementById('detailSubtitle');
            const detailContent = document.getElementById('detailContent');
            
            const type = card.getAttribute('data-type');
            const label = card.querySelector('.label').textContent;
            const value = card.querySelector('.value').textContent;
            
            // 设置标题和副标题
            detailTitle.textContent = label;
            detailSubtitle.textContent = `${currentCity.cn} - ${value}`;
            
            // 清空内容
            detailContent.innerHTML = '';
            
            // 根据类型添加不同内容
            switch(type) {
                case 'feelsLike':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">体感温度说明</div>
                            <div class="detail-item-content">
                                体感温度是指人体感受到的空气温度，受实际气温、湿度、风速和辐射等因素影响。
                                <br><br>
                                当前体感温度为 ${value}，与气温 ${document.getElementById('currentTemp').textContent} 相比，
                                ${parseInt(value) > parseInt(document.getElementById('currentTemp').textContent) ? '感觉更热' : '感觉更凉'}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">影响因素</div>
                            <div class="detail-item-content">
                                <p><strong>湿度：</strong>${document.getElementById('humidity').textContent}</p>
                                <p><strong>风速：</strong>${document.getElementById('windSpeed').textContent}</p>
                                <p><strong>日照：</strong>${document.getElementById('weatherCondition').textContent}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'humidity':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">湿度说明</div>
                            <div class="detail-item-content">
                                湿度表示空气中水蒸气的含量，影响人体的舒适度和健康。
                                <br><br>
                                当前湿度为 ${value}，属于 ${getHumidityLevel(parseInt(value))}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">湿度影响</div>
                            <div class="detail-item-content">
                                ${getHumidityEffects(parseInt(value))}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'windSpeed':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">风速说明</div>
                            <div class="detail-item-content">
                                风速是指空气流动的速度，影响体感温度和天气状况。
                                <br><br>
                                当前风速为 ${value}，属于 ${document.getElementById('windScale').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">风向信息</div>
                            <div class="detail-item-content">
                                <p><strong>风向：</strong>${document.getElementById('windDirection').textContent}</p>
                                <p><strong>风向角度：</strong>${document.getElementById('windDirectionDegree').textContent}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'pressure':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">气压说明</div>
                            <div class="detail-item-content">
                                气压是指大气对地面的压力，影响天气变化和人体舒适度。
                                <br><br>
                                当前气压为 ${value}，${getPressureLevel(parseInt(value))}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">气压与天气</div>
                            <div class="detail-item-content">
                                ${getPressureEffects(parseInt(value))}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'visibility':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">能见度说明</div>
                            <div class="detail-item-content">
                                能见度是指在白天能看清最远目标物的距离，或在夜间能看见和辨认出一定强度灯光的距离。
                                <br><br>
                                当前能见度为 ${value}，属于 ${getVisibilityLevel(parseInt(value.replace('km', '')))}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">影响因素</div>
                            <div class="detail-item-content">
                                <p><strong>天气状况：</strong>${document.getElementById('weatherCondition').textContent}</p>
                                <p><strong>湿度：</strong>${document.getElementById('humidity').textContent}</p>
                                <p><strong>空气质量：</strong>${document.getElementById('airQuality').textContent}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'uvIndex':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">紫外线指数说明</div>
                            <div class="detail-item-content">
                                紫外线指数是衡量太阳紫外线辐射强度的指标，影响人体健康和防晒需求。
                                <br><br>
                                当前紫外线指数为 ${value}，属于 ${getUVLevel(value)}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">防护建议</div>
                            <div class="detail-item-content">
                                ${getUVProtection(value)}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'precipitation':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">降水量说明</div>
                            <div class="detail-item-content">
                                降水量是指某一时段内液态或固态降水融化后，未经蒸发、渗透、流失而在水平面上积聚的深度。
                                <br><br>
                                当前降水量为 ${value}，属于 ${getPrecipitationLevel(parseFloat(value.replace('mm', '')))}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">降水影响</div>
                            <div class="detail-item-content">
                                ${getPrecipitationEffects(parseFloat(value.replace('mm', '')))}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'airQuality':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">空气质量说明</div>
                            <div class="detail-item-content">
                                空气质量反映了空气污染程度，影响人体健康和舒适度。
                                <br><br>
                                当前空气质量为 ${value}，具体指标如下：
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">空气质量指标</div>
                            <div class="detail-item-content">
                                <p><strong>AQI指数：</strong>${document.getElementById('aqi').textContent}</p>
                                <p><strong>PM2.5：</strong>${document.getElementById('pm25').textContent}</p>
                                <p><strong>PM10：</strong>${document.getElementById('pm10').textContent}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'windDirection':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">风向说明</div>
                            <div class="detail-item-content">
                                风向是指风的来向，影响天气变化和体感温度。
                                <br><br>
                                当前风向为 ${value}，风向角度为 ${document.getElementById('windDirectionDegree').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">风速信息</div>
                            <div class="detail-item-content">
                                <p><strong>风速：</strong>${document.getElementById('windSpeed').textContent}</p>
                                <p><strong>风速等级：</strong>${document.getElementById('windScale').textContent}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'windDirectionDegree':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">风向角度说明</div>
                            <div class="detail-item-content">
                                风向角度是指风向相对于正北方向的顺时针角度，0°为正北，90°为正东，180°为正南，270°为正西。
                                <br><br>
                                当前风向角度为 ${value}，表示 ${document.getElementById('windDirection').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">风向玫瑰图</div>
                            <div class="detail-item-content" style="text-align: center;">
                                <div style="width: 200px; height: 200px; margin: 0 auto; background: #f5f5f5; border-radius: 50%; position: relative;">
                                    <div style="position: absolute; top: 50%; left: 50%; width: 2px; height: 100px; background: red; transform-origin: bottom; transform: translateX(-50%) rotate(${parseInt(value)}deg);"></div>
                                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.8rem;">N</div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'windScale':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">风速等级说明</div>
                            <div class="detail-item-content">
                                风速等级是根据风速大小划分的等级，反映风的强度。
                                <br><br>
                                当前风速等级为 ${value}，对应风速为 ${document.getElementById('windSpeed').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">风速等级表</div>
                            <div class="detail-item-content">
                                <p>0级 - 无风 (0-0.2m/s)</p>
                                <p>1级 - 软风 (0.3-1.5m/s)</p>
                                <p>2级 - 轻风 (1.6-3.3m/s)</p>
                                <p>3级 - 微风 (3.4-5.4m/s)</p>
                                <p>4级 - 和风 (5.5-7.9m/s)</p>
                                <p>5级 - 劲风 (8.0-10.7m/s)</p>
                                <p>6级 - 强风 (10.8-13.8m/s)</p>
                                <p>7级 - 疾风 (13.9-17.1m/s)</p>
                                <p>8级 - 大风 (17.2-20.7m/s)</p>
                                <p>9级 - 烈风 (20.8-24.4m/s)</p>
                                <p>10级 - 狂风 (24.5-28.4m/s)</p>
                                <p>11级 - 暴风 (28.5-32.6m/s)</p>
                                <p>12级 - 飓风 (≥32.7m/s)</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'weatherCondition':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">天气状况说明</div>
                            <div class="detail-item-content">
                                天气状况描述了当前的大气现象，如晴、雨、云等。
                                <br><br>
                                当前天气状况为 ${value}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">天气图标</div>
                            <div class="detail-item-content" style="text-align: center; font-size: 3rem;">
                                <i class="fas ${getWeatherIconClass(value)} ${getWeatherIconColorClass(value)}"></i>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'sunrise':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">日出时间说明</div>
                            <div class="detail-item-content">
                                日出时间是指太阳从地平线上升起的时刻。
                                <br><br>
                                今日日出时间为 ${value}，日落时间为 ${document.getElementById('sunset').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">白昼时长</div>
                            <div class="detail-item-content">
                                ${calculateDaylightDuration(value, document.getElementById('sunset').textContent)}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'sunset':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">日落时间说明</div>
                            <div class="detail-item-content">
                                日落时间是指太阳从地平线下降落的时刻。
                                <br><br>
                                今日日落时间为 ${value}，日出时间为 ${document.getElementById('sunrise').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">白昼时长</div>
                            <div class="detail-item-content">
                                ${calculateDaylightDuration(document.getElementById('sunrise').textContent, value)}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'aqi':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">AQI指数说明</div>
                            <div class="detail-item-content">
                                AQI（空气质量指数）是定量描述空气质量状况的无量纲指数。
                                <br><br>
                                当前AQI指数为 ${value}，空气质量为 ${document.getElementById('airQuality').textContent}。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">AQI等级</div>
                            <div class="detail-item-content">
                                <p>0-50 - 优 (绿色)</p>
                                <p>51-100 - 良 (黄色)</p>
                                <p>101-150 - 轻度污染 (橙色)</p>
                                <p>151-200 - 中度污染 (红色)</p>
                                <p>201-300 - 重度污染 (紫色)</p>
                                <p>300+ - 严重污染 (褐红色)</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'pm25':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">PM2.5说明</div>
                            <div class="detail-item-content">
                                PM2.5是指空气中直径小于或等于2.5微米的颗粒物，能较长时间悬浮于空气中，对人体健康影响较大。
                                <br><br>
                                当前PM2.5浓度为 ${value} μg/m³。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">健康影响</div>
                            <div class="detail-item-content">
                                ${getPM25Effects(parseInt(value))}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'pm10':
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">PM10说明</div>
                            <div class="detail-item-content">
                                PM10是指空气中直径小于或等于10微米的颗粒物，可吸入颗粒物，对人体健康有一定影响。
                                <br><br>
                                当前PM10浓度为 ${value} μg/m³。
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-item-title">健康影响</div>
                            <div class="detail-item-content">
                                ${getPM10Effects(parseInt(value))}
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    detailContent.innerHTML = `
                        <div class="detail-item">
                            <div class="detail-item-title">${label}</div>
                            <div class="detail-item-content">${value}</div>
                        </div>
                    `;
            }
            
            // 显示弹窗
            detailOverlay.style.display = 'flex';
            setTimeout(() => {
                detailDialog.classList.add('active');
            }, 10);
        }
        
        // 辅助函数：获取湿度等级
        function getHumidityLevel(humidity) {
            if (humidity < 30) return '干燥';
            if (humidity < 60) return '舒适';
            if (humidity < 80) return '潮湿';
            return '非常潮湿';
        }
        
        // 辅助函数：获取湿度影响
        function getHumidityEffects(humidity) {
            if (humidity < 30) {
                return '干燥的空气可能导致皮肤干燥、喉咙不适，建议多喝水，使用保湿产品。';
            } else if (humidity < 60) {
                return '舒适的湿度范围，人体感觉最为舒适，适合各种活动。';
            } else if (humidity < 80) {
                return '潮湿的空气可能使人感觉闷热，物品容易受潮，建议保持通风。';
            } else {
                return '非常潮湿的天气可能使人感觉不适，物品极易发霉，建议使用除湿设备。';
            }
        }
        
        // 辅助函数：获取气压等级
        function getPressureLevel(pressure) {
            if (pressure < 970) return '极低气压';
            if (pressure < 990) return '低气压';
            if (pressure < 1020) return '正常气压';
            if (pressure < 1040) return '高气压';
            return '极高气压';
        }
        
        // 辅助函数：获取气压影响
        function getPressureEffects(pressure) {
            if (pressure < 970) {
                return '极低气压通常伴随强风和降水天气，可能引发风暴或台风，需注意安全。';
            } else if (pressure < 990) {
                return '低气压通常伴随多云或降水天气，可能使人感觉疲倦或不适。';
            } else if (pressure < 1020) {
                return '正常气压范围，天气通常较为稳定，人体感觉舒适。';
            } else if (pressure < 1040) {
                return '高气压通常伴随晴朗天气，空气较为干燥，昼夜温差可能较大。';
            } else {
                return '极高气压较为罕见，可能导致异常干燥的天气，需注意防火。';
            }
        }
        
        // 辅助函数：获取能见度等级
        function getVisibilityLevel(visibility) {
            if (visibility < 1) return '极低能见度';
            if (visibility < 5) return '低能见度';
            if (visibility < 10) return '中等能见度';
            if (visibility < 20) return '良好能见度';
            return '极好能见度';
        }
        
        // 辅助函数：获取紫外线等级
        function getUVLevel(uvIndex) {
            if (uvIndex === '弱') return '低 (0-2)';
            if (uvIndex === '中等') return '中等 (3-5)';
            if (uvIndex === '强') return '高 (6-7)';
            if (uvIndex === '很强') return '非常高 (8-10)';
            return '极高 (11+)';
        }
        
        // 辅助函数：获取紫外线防护建议
        function getUVProtection(uvIndex) {
            if (uvIndex === '弱') {
                return '紫外线较弱，一般不需要特别防护。';
            } else if (uvIndex === '中等') {
                return '紫外线中等强度，建议佩戴太阳镜，使用SPF15+防晒霜。';
            } else if (uvIndex === '强') {
                return '紫外线较强，建议佩戴太阳镜和帽子，使用SPF30+防晒霜，尽量在阴凉处活动。';
            } else if (uvIndex === '很强') {
                return '紫外线非常强，建议避免在10点至16点外出，必须外出时做好全面防护。';
            } else {
                return '紫外线极高，非常危险，应尽量避免外出，必须外出时需采取最强防护措施。';
            }
        }
        
        // 辅助函数：获取降水量等级
        function getPrecipitationLevel(precipitation) {
            if (precipitation === 0) return '无降水';
            if (precipitation < 2.5) return '小雨';
            if (precipitation < 10) return '中雨';
            if (precipitation < 25) return '大雨';
            if (precipitation < 50) return '暴雨';
            return '大暴雨';
        }
        
        // 辅助函数：获取降水影响
        function getPrecipitationEffects(precipitation) {
            if (precipitation === 0) {
                return '无降水，天气干燥，适合户外活动。';
            } else if (precipitation < 2.5) {
                return '小雨对出行影响较小，但路面可能湿滑，建议携带雨具。';
            } else if (precipitation < 10) {
                return '中雨可能影响户外活动，建议穿防水鞋服，注意交通安全。';
            } else if (precipitation < 25) {
                return '大雨可能导致局部积水，建议避免不必要的出行，注意防范。';
            } else if (precipitation < 50) {
                return '暴雨可能导致城市内涝，建议待在安全室内，避免外出。';
            } else {
                return '大暴雨非常危险，可能导致严重洪涝灾害，务必注意安全。';
            }
        }
        
        // 辅助函数：获取PM2.5影响
        function getPM25Effects(pm25) {
            if (pm25 <= 35) {
                return '空气质量良好，对健康人群无明显影响。';
            } else if (pm25 <= 75) {
                return '空气质量可接受，但某些污染物可能对极少数敏感人群有较弱影响。';
            } else if (pm25 <= 115) {
                return '敏感人群症状可能加剧，健康人群可能出现刺激症状。';
            } else if (pm25 <= 150) {
                return '进一步加剧易感人群症状，可能对健康人群心脏、呼吸系统产生影响。';
            } else if (pm25 <= 250) {
                return '心脏病和肺病患者症状显著加剧，运动耐受力降低，健康人群普遍受影响。';
            } else {
                return '健康人群运动耐受力降低，有明显强烈症状，提前出现某些疾病。';
            }
        }
        
        // 辅助函数：获取PM10影响
        function getPM10Effects(pm10) {
            if (pm10 <= 50) {
                return '空气质量良好，对健康人群无明显影响。';
            } else if (pm10 <= 150) {
                return '空气质量可接受，但某些污染物可能对极少数敏感人群有较弱影响。';
            } else if (pm10 <= 250) {
                return '敏感人群症状可能加剧，健康人群可能出现刺激症状。';
            } else if (pm10 <= 350) {
                return '进一步加剧易感人群症状，可能对健康人群心脏、呼吸系统产生影响。';
            } else if (pm10 <= 420) {
                return '心脏病和肺病患者症状显著加剧，运动耐受力降低，健康人群普遍受影响。';
            } else {
                return '健康人群运动耐受力降低，有明显强烈症状，提前出现某些疾病。';
            }
        }
        
        // 辅助函数：获取天气图标类
        function getWeatherIconClass(weather) {
            weather = weather.toLowerCase();
            if (weather.includes('晴')) return 'fa-sun';
            if (weather.includes('雨')) return 'fa-cloud-rain';
            if (weather.includes('云') || weather.includes('阴')) return 'fa-cloud';
            return 'fa-cloud';
        }
        
        // 辅助函数：获取天气图标颜色类
        function getWeatherIconColorClass(weather) {
            weather = weather.toLowerCase();
            if (weather.includes('晴')) return 'sunny-icon';
            if (weather.includes('雨')) return 'rainy-icon';
            if (weather.includes('云') || weather.includes('阴')) return 'cloudy-icon';
            return 'cloudy-icon';
        }
        
        // 辅助函数：计算白昼时长
        function calculateDaylightDuration(sunrise, sunset) {
            const parseTime = time => {
                const [hours, minutes] = time.split(':').map(Number);
                return hours * 60 + minutes;
            };
            
            const sunriseMinutes = parseTime(sunrise);
            const sunsetMinutes = parseTime(sunset);
            
            const daylightMinutes = sunsetMinutes - sunriseMinutes;
            const hours = Math.floor(daylightMinutes / 60);
            const minutes = daylightMinutes % 60;
            
            return `今日白昼时长为 ${hours}小时${minutes}分钟。`;
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            initCitySelector();
            initDetailDialog();
            fetchWeatherData(currentCity);
        });
    </script>
</body>
</html>
